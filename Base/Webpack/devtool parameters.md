---
tags:
  - webpack
---

Есть разные варианты параметра devtool:
- none
- eval
- source-map
- eval-source-map
- cheap-source-map
и так далее.

Он указывается в файле webpack.config.js таким способом:

```js
module.exports = {
    return {
        ...
        devtool: 'eval',
        ...
   }
 }
```

Данный параметр позволяет генерировать карты ресурсов, что позволяет легче отлаживать код. Есть различные способы как можно создать карты ресурсов и нужно искать компромисс между качеством карт и производительностью (так как на генерацию карт webpack тратит время плюс размер сборки увеличивается из-за  дополнительной информации).

eval - Это компромиссное решение. В этом режиме Webpack оборачивает весь код бандла в eval и добавляет в конце eval-а диррективу //# sourceURL=my-file.js. Это работает так, что когда браузер выполняет код из eval и видет директиву //# sourceUrl, то он создает в Source файл с именем my-file.js, в котором отображается весь код, написанный в eval с учетом форматирования. Вот пример использования eval вместе # sourceURL:

```js
eval("let name = 'Karen';\n\rconsole.log('hello '+name)//# sourceURL=my-file.js");
```

Если мы выполним этот код в новой пустой вкладке. то мы видим во вкладке source в браузере:

![[webpack-source-map.png]]

Вот как будет выглядить бандл в devtools:

![[webpack-eval-result.png]]

Как видно, код неплохо читаем, но все же карты получаются не идеальные.

Есть другой способ без использования eval, а именно создание для каждого js скрипта файла с расширением .js.map (на самом деле это можно делать не только для js, но и для css и даже для ts и scss файлов!). Такие файлы сопоставляют минифицированный файл с его расширенной версией. Современная версия .map файла имеет такой вид:

```js
{
	"version": 3,//версия map файла (3 версия актуальна на данный момент)
	"sources": ["counter.js", "index.js"],//именна исходных файлов
	"names":["alert","MyCounter","startValue","counter","Counter"], //имена функций, классов и переменных, которые были минифицированны или удалены
	 "mappings": "CAAA,SAAAA,GAAA,GAAA,iBAAAC,SAAA,…", //Сопоставление позиций токенов в минифицированном и исходном файле
	 "sourcesContent": ["...минифицированный код..."],
	 "sourceRoot": "/path/to/static/assets",
	 "file": "main.9a61516b88c4ea55590e.js"
}
```

Вот как выглядит отладка:

![[webpack-source-map-example.png]]

Как видно, качество отладки намного выше, но при этом Webpack'у нужно тратить время чтобы сгенерировать лишний .map файл.

---
## Резюме

Существуют разные подходы для работы с картами ресурсов в Webpack и при выборе того или иного способа нужно руководствоваться в каком режиме собирается сборка (прод или дев) и учитывать то что сборку можно ускорить отключив генерацию source-map или использовать другой режим генерации карт ресурсов, который менее затратен по ресурсам.