#typescript

На самом деле этот вопрос задавал мне Игорь на карточке по ts. Действительно у enum есть свои недостатки из-за которых многие советуют их избегать. Во всяком случае распространенная практика - избегать численные enum (многие даже пишут кастомные правила линтера, которые ругаются на численные enum).

Если мы посмотрим во что ts компилит enum, то мы можем увидет следующее:

![[typescript-enums.png]]
Сам факт того, что ts вообще что-то оставляет в рантайме уже не вяжется с концепцией того, что ts никак не влияет на рантайм и все типы исчезают в процессе компиляции. Но неприятность в том что если мы захотим конвертировать enum в объект и перемапить его ключи то мы получим следующее:

![[typescript-numberic-enums.png]]


То есть численные константы также являются ключами и мы можем получать доступ к элементам с использованием численных индексов. Чтобы отобрать у пользователя возможность работать с enum таким образом, мы можем использовать строковые константы в enum:

![[typescript-string-enum.png]]

Это уже выглядит лучше. Но на самом деле у нас есть неплохая альтернатива (про которую мне когда-то говорил Игорь), а именно: константный объект:

![[typescript-const-obj.png]]
Достоинство этого подхода заключается в том что этот способ более гибкий чем enum:

```ts
const Status = {
	LOADING: "LOADING",
	SUCCESS: "SUCCESS",
	ERROR: "ERROR"
} as const;

type StatusKeys = keyof typeof Status;

const setStatus = (status: StatusKeys) => console.log(status);

setStatus(Status.SUCCESS);

setStatus('SUCCESS'); // <= Так тоже можно
```

А вот с enum так нельзя:

```ts
enum Status {
	LOADING = "LOADING",
	SUCCESS = "SUCCESS",
	ERROR = "ERROR"
};

const setStatus = (status: Status) => console.log(status);

setStatus(Status.SUCCESS);

setStatus('SUCCESS'); // <= Так нельзя. Argument of type '"SUCCESS"' is not assignable to parameter of type 'Status'
```

Плюс в пользу этого подхода можно сказать в коде нам может понадобиться использовать объект с константами (например замапить его в выпадающий список чтобы получить список статусов). Использовать в js рантайме enum это странный подход, так как мешать вместе типизацию и непосредственно код, не очень красиво.

Также про enum можно сказать что он может быть константным. Константный enum отличается от обычного тем, что он исчезает из рантайма и мы не сможем получить к нему доступ из js:

![[typescript-const-enum.png]]

___
## Резюме

По итогу не думаю что можно сказать что enum устарел и его не нужно использовать в проектах. Просто у него есть прикольная альтернатива. Насчет численных констант в enum, их все же использовать не желательно, а константные и enum со строковыми константами использовать вполне нормально.

P. s. Если кто-то имеет какое-то мнение на этот счет, то можно дополнить эту статью :)
